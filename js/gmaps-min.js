"use strict";!function(b,a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(["jquery","googlemaps!"],a):b.GMaps=a()}(this,function(){function h(m,a){if(m===a){return m}for(var n in a){void 0!==a[n]&&(m[n]=a[n])}return m}function b(q,s){var m,u=Array.prototype.slice.call(arguments,2),a=[],p=q.length;if(Array.prototype.map&&q.map===Array.prototype.map){a=Array.prototype.map.call(q,function(o){var n=u.slice(0);return n.splice(0,0,o),s.apply(this,n)})}else{for(m=0;m<p;m++){callback_params=u,callback_params.splice(0,0,q[m]),a.push(s.apply(this,callback_params))}}return a}function l(m){for(var a=[],n=0;n<m.length;n++){a=a.concat(m[n])}return a}function j(m,a){var m=m.replace("#","");return m="jQuery" in window&&a?$("#"+m,a)[0]:document.getElementById(m)}var c,g,k,f,i=function(u,m){for(var v,w,a,q,p=0;p<u.length;p++){u[p] instanceof google.maps.LatLng||(0<u[p].length&&"object"==typeof u[p][0]?u[p]=i(u[p],m):u[p]=(v=u[p],w=m,q=a=void 0,a=v[0],q=v[1],w&&(a=v[1],q=v[0]),new google.maps.LatLng(a,q)))}return u},d=(c=document,g=function(G){if("object"!=typeof window.google||!window.google.maps){return"object"==typeof window.console&&window.console.error&&console.error("Google Maps API is required. Please register the following JavaScript library https://maps.googleapis.com/maps/api/js."),function(){}}if(!this){return new g(G)}G.zoom=G.zoom||15,G.mapType=G.mapType||"roadmap";var Q,C=function(m,a){return void 0===m?a:m},N=this,H=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],M=["mousemove","mouseout","mouseover"],E=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],D=G.el||G.div,U=G.markerClusterer,J=google.maps.MapTypeId[G.mapType.toUpperCase()],F=new google.maps.LatLng(G.lat,G.lng),S=C(G.zoomControl,!0),O=G.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},B=O.style||"DEFAULT",R=O.position||"TOP_LEFT",I=C(G.panControl,!0),P=C(G.mapTypeControl,!0),O=C(G.scaleControl,!0),C=C(G.streetViewControl,!0),x={},J={zoom:this.zoom,center:F,mapTypeId:J},C={panControl:I,zoomControl:S,zoomControlOptions:{style:google.maps.ZoomControlStyle[B],position:google.maps.ControlPosition[R]},mapTypeControl:P,scaleControl:O,streetViewControl:C,overviewMapControl:!0};if("string"==typeof G.el||"string"==typeof G.div?-1<D.indexOf("#")?this.el=j(D,G.context):this.el=function(m,a){var m=m.replace(".",""),m=("jQuery" in this&&a?$("."+m,a):document.getElementsByClassName(m))[0];return m}.apply(this,[D,G.context]):this.el=D,void 0===this.el||null===this.el){throw"No element defined."}for(window.context_menu=window.context_menu||{},window.context_menu[N.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=G.zoom,this.registered_events={},this.el.style.width=G.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=G.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=G.enableNewStyle,Q=0;Q<E.length;Q++){delete G[E[Q]]}for(1!=G.disableDefaultUI&&(J=h(J,C)),x=h(J,G),Q=0;Q<H.length;Q++){delete x[H[Q]]}for(Q=0;Q<M.length;Q++){delete x[M[Q]]}this.map=new google.maps.Map(this.el,x),U&&(this.markerClusterer=U.apply(this,[this.map]));function A(aa,v){var X,w="",L=window.context_menu[N.el.id][aa];for(ab in L){L.hasOwnProperty(ab)&&(X=L[ab],w+='<li><a id="'+aa+"_"+ab+'" href="#">'+X.title+"</a></li>")}if(j("gmaps_context_menu")){var m=j("gmaps_context_menu");m.innerHTML=w;var ab,Z=m.getElementsByTagName("a"),y=Z.length;for(ab=0;ab<y;ab++){var u=Z[ab];google.maps.event.clearListeners(u,"click"),google.maps.event.addDomListenerOnce(u,"click",function(a){a.preventDefault(),L[this.id.replace(aa+"_","")].action.apply(N,[v]),N.hideContextMenu()},!1)}var Y=function(ac){var p=0,ad=0;if(ac.getBoundingClientRect){var ae=ac.getBoundingClientRect(),a=-(window.scrollX||window.pageXOffset),s=-(window.scrollY||window.pageYOffset);return[ae.left-a,ae.top-s]}if(ac.offsetParent){for(;p+=ac.offsetLeft,ad+=ac.offsetTop,ac=ac.offsetParent;){}}return[p,ad]}.apply(this,[N.el]),W=Y[0]+v.pixel.x-15,Y=Y[1]+v.pixel.y-15;m.style.left=W+"px",m.style.top=Y+"px"}}this.buildContextMenu=function(p,r){var a;"marker"===p?(r.pixel={},(a=new google.maps.OverlayView).setMap(N.map),a.draw=function(){var o=a.getProjection(),n=r.marker.getPosition();r.pixel=o.fromLatLngToContainerPixel(n),A(p,r)}):A(p,r);var m=j("gmaps_context_menu");setTimeout(function(){m.style.display="block"},0)},this.setContextMenu=function(p){window.context_menu[N.el.id][p.control]={};var m,r,s=c.createElement("ul");for(m in p.options){p.options.hasOwnProperty(m)&&(r=p.options[m],window.context_menu[N.el.id][p.control][r.name]={title:r.title,action:r.action})}s.id="gmaps_context_menu",s.style.display="none",s.style.position="absolute",s.style.minWidth="100px",s.style.background="white",s.style.listStyle="none",s.style.padding="8px",s.style.boxShadow="2px 2px 6px #ccc",j("gmaps_context_menu")||c.body.appendChild(s);var a=j("gmaps_context_menu");google.maps.event.addDomListener(a,"mouseout",function(n){n.relatedTarget&&this.contains(n.relatedTarget)||window.setTimeout(function(){a.style.display="none"},400)},!1)},this.hideContextMenu=function(){var a=j("gmaps_context_menu");a&&(a.style.display="none")};function z(m,a){google.maps.event.addListener(m,a,function(n){null==n&&(n=this),G[a].apply(this,[n]),N.hideContextMenu()})}google.maps.event.addListener(this.map,"zoom_changed",this.hideContextMenu);for(var K=0;K<H.length;K++){(q=H[K]) in G&&z(this.map,q)}for(var q,K=0;K<M.length;K++){(q=M[K]) in G&&z(this.map,q)}google.maps.event.addListener(this.map,"rightclick",function(a){G.rightclick&&G.rightclick.apply(this,[a]),null!=window.context_menu[N.el.id].map&&N.buildContextMenu("map",a)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){for(var m=[],a=this.markers.length,n=0;n<a;n++){"boolean"==typeof this.markers[n].visible&&this.markers[n].visible&&m.push(this.markers[n].getPosition())}this.fitLatLngBounds(m)},this.fitLatLngBounds=function(m){for(var a=m.length,p=new google.maps.LatLngBounds,r=0;r<a;r++){p.extend(m[r])}this.map.fitBounds(p)},this.setCenter=function(m,a,n){this.map.panTo(new google.maps.LatLng(m,a)),n&&n()},this.getElement=function(){return this.el},this.zoomIn=function(a){a=a||1,this.zoom=this.map.getZoom()+a,this.map.setZoom(this.zoom)},this.zoomOut=function(a){a=a||1,this.zoom=this.map.getZoom()-a,this.map.setZoom(this.zoom)};var T,V=[];for(T in this.map){"function"!=typeof this.map[T]||this[T]||V.push(T)}for(Q=0;Q<V.length;Q++){!function(m,a,n){m[n]=function(){return a[n].apply(a,arguments)}}(this,this.map,V[Q])}});return d.prototype.createControl=function(a){var m,p,q=document.createElement("div");for(m in q.style.cursor="pointer",!0!==a.disableDefaultStyles&&(q.style.fontFamily="Roboto, Arial, sans-serif",q.style.fontSize="11px",q.style.boxShadow="rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px"),a.style){q.style[m]=a.style[m]}for(p in a.id&&(q.id=a.id),a.title&&(q.title=a.title),a.classes&&(q.className=a.classes),a.content&&("string"==typeof a.content?q.innerHTML=a.content:a.content instanceof HTMLElement&&q.appendChild(a.content)),a.position&&(q.position=google.maps.ControlPosition[a.position.toUpperCase()]),a.events){!function(n){google.maps.event.addDomListener(q,n,function(){a.events[n].apply(this,[this])})}(p)}return q.index=1,q},d.prototype.addControl=function(a){a=this.createControl(a);return this.controls.push(a),this.map.controls[a.position].push(a),a},d.prototype.removeControl=function(m){for(var a=null,p=0;p<this.controls.length;p++){this.controls[p]==m&&(a=this.controls[p].position,this.controls.splice(p,1))}if(a){for(p=0;p<this.map.controls.length;p++){var q=this.map.controls[m.position];if(q.getAt(p)==m){q.removeAt(p);break}}}return m},d.prototype.createMarker=function(v){if(null==v.lat&&null==v.lng&&null==v.position){throw"No latitude or longitude defined."}var B=this,y=v.details,u=v.fences,x=v.outside,m={position:new google.maps.LatLng(v.lat,v.lng),map:null},m=h(m,v);delete m.lat,delete m.lng,delete m.fences,delete m.outside;var C=new google.maps.Marker(m);if(C.fences=u,v.infoWindow){C.infoWindow=new google.maps.InfoWindow(v.infoWindow);for(var A=["closeclick","content_changed","domready","position_changed","zindex_changed"],w=0;w<A.length;w++){!function(n,a){v.infoWindow[a]&&google.maps.event.addListener(n,a,function(o){v.infoWindow[a].apply(this,[o])})}(C.infoWindow,A[w])}}for(var q=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],z=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],w=0;w<q.length;w++){!function(a){v[a]&&google.maps.event.addListener(C,a,function(){v[a].apply(this,[this])})}(q[w])}for(w=0;w<z.length;w++){!function(a,n){v[n]&&google.maps.event.addListener(C,n,function(o){o.pixel||(o.pixel=a.getProjection().fromLatLngToPoint(o.latLng)),v[n].apply(this,[o])})}(this.map,z[w])}return google.maps.event.addListener(C,"click",function(){this.details=y,v.click&&v.click.apply(this,[this]),C.infoWindow&&(B.hideInfoWindows(),C.infoWindow.open(B.map,C))}),google.maps.event.addListener(C,"rightclick",function(a){a.marker=this,v.rightclick&&v.rightclick.apply(this,[a]),null!=window.context_menu[B.el.id].marker&&B.buildContextMenu("marker",a)}),C.fences&&google.maps.event.addListener(C,"dragend",function(){B.checkMarkerGeofence(C,function(n,a){x(n,a)})}),C},d.prototype.addMarker=function(m){var a;if(m.hasOwnProperty("gm_accessors_")){a=m}else{if(!(m.hasOwnProperty("lat")&&m.hasOwnProperty("lng")||m.position)){throw"No latitude or longitude defined."}a=this.createMarker(m)}return a.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(a),this.markers.push(a),d.fire("marker_added",a,this),a},d.prototype.addMarkers=function(m){for(var a,n=0;a=m[n];n++){this.addMarker(a)}return this.markers},d.prototype.hideInfoWindows=function(){for(var m,a=0;m=this.markers[a];a++){m.infoWindow&&m.infoWindow.close()}},d.prototype.removeMarker=function(m){for(var a=0;a<this.markers.length;a++){if(this.markers[a]===m){this.markers[a].setMap(null),this.markers.splice(a,1),this.markerClusterer&&this.markerClusterer.removeMarker(m),d.fire("marker_removed",m,this);break}}return m},d.prototype.removeMarkers=function(p){var m=[];if(void 0===p){for(var q=0;q<this.markers.length;q++){(a=this.markers[q]).setMap(null),d.fire("marker_removed",a,this)}this.markerClusterer&&this.markerClusterer.clearMarkers&&this.markerClusterer.clearMarkers(),this.markers=m}else{for(q=0;q<p.length;q++){var r=this.markers.indexOf(p[q]);-1<r&&((a=this.markers[r]).setMap(null),this.markerClusterer&&this.markerClusterer.removeMarker(a),d.fire("marker_removed",a,this))}for(var a,q=0;q<this.markers.length;q++){null!=(a=this.markers[q]).getMap()&&m.push(a)}this.markers=m}},d.prototype.drawOverlay=function(o){var n=new google.maps.OverlayView,m=!0;return n.setMap(this.map),null!=o.auto_show&&(m=o.auto_show),n.onAdd=function(){var q=document.createElement("div");q.style.borderStyle="none",q.style.borderWidth="0px",q.style.position="absolute",q.style.zIndex=100,q.innerHTML=o.content,n.el=q,o.layer||(o.layer="overlayLayer");var p=this.getPanes(),r=["contextmenu","DOMMouseScroll","dblclick","mousedown"];p[o.layer].appendChild(q);for(var s,a=0;a<r.length;a++){s=r[a],google.maps.event.addDomListener(q,s,function(t){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&document.all?(t.cancelBubble=!0,t.returnValue=!1):t.stopPropagation()})}o.click&&(p.overlayMouseTarget.appendChild(n.el),google.maps.event.addDomListener(n.el,"click",function(){o.click.apply(n,[n])})),google.maps.event.trigger(this,"ready")},n.draw=function(){var q=this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(o.lat,o.lng));o.horizontalOffset=o.horizontalOffset||0,o.verticalOffset=o.verticalOffset||0;var p=n.el,r=p.children[0],s=r.clientHeight,a=r.clientWidth;switch(o.verticalAlign){case"top":p.style.top=q.y-s+o.verticalOffset+"px";break;default:case"middle":p.style.top=q.y-s/2+o.verticalOffset+"px";break;case"bottom":p.style.top=q.y+o.verticalOffset+"px"}switch(o.horizontalAlign){case"left":p.style.left=q.x-a+o.horizontalOffset+"px";break;default:case"center":p.style.left=q.x-a/2+o.horizontalOffset+"px";break;case"right":p.style.left=q.x+o.horizontalOffset+"px"}p.style.display=m?"block":"none",m||o.show.apply(this,[p])},n.onRemove=function(){var a=n.el;o.remove?o.remove.apply(this,[a]):(n.el.parentNode.removeChild(n.el),n.el=null)},this.overlays.push(n),n},d.prototype.removeOverlay=function(m){for(var a=0;a<this.overlays.length;a++){if(this.overlays[a]===m){this.overlays[a].setMap(null),this.overlays.splice(a,1);break}}},d.prototype.removeOverlays=function(){for(var m,a=0;m=this.overlays[a];a++){m.setMap(null)}this.overlays=[]},d.prototype.drawPolyline=function(p){var w=[],y=p.path;if(y.length){if(void 0===y[0][0]){w=y}else{for(var q,v=0;q=y[v];v++){w.push(new google.maps.LatLng(q[0],q[1]))}}}var m={map:this.map,path:w,strokeColor:p.strokeColor,strokeOpacity:p.strokeOpacity,strokeWeight:p.strokeWeight,geodesic:p.geodesic,clickable:!0,editable:!1,visible:!0};p.hasOwnProperty("clickable")&&(m.clickable=p.clickable),p.hasOwnProperty("editable")&&(m.editable=p.editable),p.hasOwnProperty("icons")&&(m.icons=p.icons),p.hasOwnProperty("zIndex")&&(m.zIndex=p.zIndex);for(var z=new google.maps.Polyline(m),x=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],u=0;u<x.length;u++){!function(a){p[a]&&google.maps.event.addListener(z,a,function(n){p[a].apply(this,[n])})}(x[u])}return this.polylines.push(z),d.fire("polyline_added",z,this),z},d.prototype.removePolyline=function(m){for(var a=0;a<this.polylines.length;a++){if(this.polylines[a]===m){this.polylines[a].setMap(null),this.polylines.splice(a,1),d.fire("polyline_removed",m,this);break}}},d.prototype.removePolylines=function(){for(var m,a=0;m=this.polylines[a];a++){m.setMap(null)}this.polylines=[]},d.prototype.drawCircle=function(p){delete (p=h({map:this.map,center:new google.maps.LatLng(p.lat,p.lng)},p)).lat,delete p.lng;for(var m=new google.maps.Circle(p),a=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],q=0;q<a.length;q++){!function(n){p[n]&&google.maps.event.addListener(m,n,function(o){p[n].apply(this,[o])})}(a[q])}return this.polygons.push(m),m},d.prototype.drawRectangle=function(q){q=h({map:this.map},q);var p=new google.maps.LatLngBounds(new google.maps.LatLng(q.bounds[0][0],q.bounds[0][1]),new google.maps.LatLng(q.bounds[1][0],q.bounds[1][1]));q.bounds=p;for(var r=new google.maps.Rectangle(q),m=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],a=0;a<m.length;a++){!function(n){q[n]&&google.maps.event.addListener(r,n,function(o){q[n].apply(this,[o])})}(m[a])}return this.polygons.push(r),r},d.prototype.drawPolygon=function(q){var p=!1;q.hasOwnProperty("useGeoJSON")&&(p=q.useGeoJSON),delete q.useGeoJSON,q=h({map:this.map},q),0==p&&(q.paths=[q.paths.slice(0)]),0<q.paths.length&&0<q.paths[0].length&&(q.paths=l(b(q.paths,i,p)));for(var r=new google.maps.Polygon(q),m=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],a=0;a<m.length;a++){!function(n){q[n]&&google.maps.event.addListener(r,n,function(o){q[n].apply(this,[o])})}(m[a])}return this.polygons.push(r),d.fire("polygon_added",r,this),r},d.prototype.removePolygon=function(m){for(var a=0;a<this.polygons.length;a++){if(this.polygons[a]===m){this.polygons[a].setMap(null),this.polygons.splice(a,1),d.fire("polygon_removed",m,this);break}}},d.prototype.removePolygons=function(){for(var m,a=0;m=this.polygons[a];a++){m.setMap(null)}this.polygons=[]},d.prototype.getFromFusionTables=function(m){var p=m.events;delete m.events;var a,q=new google.maps.FusionTablesLayer(m);for(a in p){!function(n){google.maps.event.addListener(q,n,function(o){p[n].apply(this,[o])})}(a)}return this.layers.push(q),q},d.prototype.loadFromFusionTables=function(a){a=this.getFromFusionTables(a);return a.setMap(this.map),a},d.prototype.getFromKML=function(p){var m=p.url,q=p.events;delete p.url,delete p.events;var r,a=new google.maps.KmlLayer(m,p);for(r in q){!function(n){google.maps.event.addListener(a,n,function(o){q[n].apply(this,[o])})}(r)}return this.layers.push(a),a},d.prototype.loadFromKML=function(a){a=this.getFromKML(a);return a.setMap(this.map),a},d.prototype.addLayer=function(m,a){var p,q;switch(a=a||{},m){case"weather":this.singleLayers.weather=p=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=p=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=p=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=p=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=p=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=p=new google.maps.panoramio.PanoramioLayer,p.setTag(a.filter),delete a.filter,a.click&&google.maps.event.addListener(p,"click",function(n){a.click(n),delete a.click});break;case"places":this.singleLayers.places=p=new google.maps.places.PlacesService(this.map),(a.search||a.nearbySearch||a.radarSearch)&&(q={bounds:a.bounds||null,keyword:a.keyword||null,location:a.location||null,name:a.name||null,radius:a.radius||null,rankBy:a.rankBy||null,types:a.types||null},a.radarSearch&&p.radarSearch(q,a.radarSearch),a.search&&p.search(q,a.search),a.nearbySearch&&p.nearbySearch(q,a.nearbySearch)),a.textSearch&&(q={bounds:a.bounds||null,location:a.location||null,query:a.query||null,radius:a.radius||null},p.textSearch(q,a.textSearch))}if(void 0!==p){return"function"==typeof p.setOptions&&p.setOptions(a),"function"==typeof p.setMap&&p.setMap(this.map),p}},d.prototype.removeLayer=function(m){if("string"==typeof m&&void 0!==this.singleLayers[m]){this.singleLayers[m].setMap(null),delete this.singleLayers[m]}else{for(var a=0;a<this.layers.length;a++){if(this.layers[a]===m){this.layers[a].setMap(null),this.layers.splice(a,1);break}}}},d.prototype.getRoutes=function(o){switch(o.travelMode){case"bicycling":k=google.maps.TravelMode.BICYCLING;break;case"transit":k=google.maps.TravelMode.TRANSIT;break;case"driving":k=google.maps.TravelMode.DRIVING;break;default:k=google.maps.TravelMode.WALKING}f="imperial"===o.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var m=h({avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]},o);m.origin=/string/.test(typeof o.origin)?o.origin:new google.maps.LatLng(o.origin[0],o.origin[1]),m.destination=/string/.test(typeof o.destination)?o.destination:new google.maps.LatLng(o.destination[0],o.destination[1]),m.travelMode=k,m.unitSystem=f,delete m.callback,delete m.error;var a=[];(new google.maps.DirectionsService).route(m,function(p,n){if(n===google.maps.DirectionsStatus.OK){for(var q in p.routes){p.routes.hasOwnProperty(q)&&a.push(p.routes[q])}o.callback&&o.callback(a,p,n)}else{o.error&&o.error(p,n)}})},d.prototype.removeRoutes=function(){this.routes.length=0},d.prototype.getElevations=function(m){0<(m=h({locations:[],path:!1,samples:256},m)).locations.length&&0<m.locations[0].length&&(m.locations=l(b([m.locations],i,!1)));var p=m.callback;delete m.callback;var a,q=new google.maps.ElevationService;m.path?(a={path:m.locations,samples:m.samples},q.getElevationAlongPath(a,function(o,n){p&&"function"==typeof p&&p(o,n)})):(delete m.path,delete m.samples,q.getElevationForLocations(m,function(o,n){p&&"function"==typeof p&&p(o,n)}))},d.prototype.cleanRoute=d.prototype.removePolylines,d.prototype.renderRoute=function(m,a){var q,p="string"==typeof a.panel?document.getElementById(a.panel.replace("#","")):a.panel;a.panel=p,a=h({map:this.map},a),q=new google.maps.DirectionsRenderer(a),this.getRoutes({origin:m.origin,destination:m.destination,travelMode:m.travelMode,waypoints:m.waypoints,unitSystem:m.unitSystem,error:m.error,avoidHighways:m.avoidHighways,avoidTolls:m.avoidTolls,optimizeWaypoints:m.optimizeWaypoints,callback:function(r,n,s){s===google.maps.DirectionsStatus.OK&&q.setDirections(n)}})},d.prototype.drawRoute=function(a){var m=this;this.getRoutes({origin:a.origin,destination:a.destination,travelMode:a.travelMode,waypoints:a.waypoints,unitSystem:a.unitSystem,error:a.error,avoidHighways:a.avoidHighways,avoidTolls:a.avoidTolls,optimizeWaypoints:a.optimizeWaypoints,callback:function(o){var n;0<o.length&&(n={path:o[o.length-1].overview_path,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight},a.hasOwnProperty("icons")&&(n.icons=a.icons),m.drawPolyline(n),a.callback&&a.callback(o[o.length-1]))}})},d.prototype.travelRoute=function(m){if(m.origin&&m.destination){this.getRoutes({origin:m.origin,destination:m.destination,travelMode:m.travelMode,waypoints:m.waypoints,unitSystem:m.unitSystem,error:m.error,callback:function(s){if(0<s.length&&m.start&&m.start(s[s.length-1]),0<s.length&&m.step){var r=s[s.length-1];if(0<r.legs.length){for(var u,v=r.legs[0].steps,q=0;u=v[q];q++){u.step_number=q,m.step(u,r.legs[0].steps.length-1)}}}0<s.length&&m.end&&m.end(s[s.length-1])}})}else{if(m.route&&0<m.route.legs.length){for(var n,a=m.route.legs[0].steps,p=0;n=a[p];p++){n.step_number=p,m.step(n)}}}},d.prototype.drawSteppedRoute=function(q){var m=this;if(q.origin&&q.destination){this.getRoutes({origin:q.origin,destination:q.destination,travelMode:q.travelMode,waypoints:q.waypoints,error:q.error,callback:function(x){if(0<x.length&&q.start&&q.start(x[x.length-1]),0<x.length&&q.step){var s=x[x.length-1];if(0<s.legs.length){for(var y,z=s.legs[0].steps,a=0;y=z[a];a++){y.step_number=a;var w={path:y.path,strokeColor:q.strokeColor,strokeOpacity:q.strokeOpacity,strokeWeight:q.strokeWeight};q.hasOwnProperty("icons")&&(w.icons=q.icons),m.drawPolyline(w),q.step(y,s.legs[0].steps.length-1)}}}0<x.length&&q.end&&q.end(x[x.length-1])}})}else{if(q.route&&0<q.route.legs.length){for(var r,p=q.route.legs[0].steps,u=0;r=p[u];u++){r.step_number=u;var v={path:r.path,strokeColor:q.strokeColor,strokeOpacity:q.strokeOpacity,strokeWeight:q.strokeWeight};q.hasOwnProperty("icons")&&(v.icons=q.icons),m.drawPolyline(v),q.step(r)}}}},d.Route=function(m){this.origin=m.origin,this.destination=m.destination,this.waypoints=m.waypoints,this.map=m.map,this.route=m.route,this.step_count=0,this.steps=this.route.legs[0].steps,this.steps_length=this.steps.length;var a={path:new google.maps.MVCArray,strokeColor:m.strokeColor,strokeOpacity:m.strokeOpacity,strokeWeight:m.strokeWeight};m.hasOwnProperty("icons")&&(a.icons=m.icons),this.polyline=this.map.drawPolyline(a).getPath()},d.Route.prototype.getRoute=function(a){var m=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:a.travelMode,waypoints:this.waypoints||[],error:a.error,callback:function(){m.route=e[0],a.callback&&a.callback.call(m)}})},d.Route.prototype.back=function(){if(0<this.step_count){this.step_count--;var m,a=this.route.legs[0].steps[this.step_count].path;for(m in a){a.hasOwnProperty(m)&&this.polyline.pop()}}},d.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var m,a=this.route.legs[0].steps[this.step_count].path;for(m in a){a.hasOwnProperty(m)&&this.polyline.push(a[m])}this.step_count++}},d.prototype.checkGeofence=function(m,a,n){return n.containsLatLng(new google.maps.LatLng(m,a))},d.prototype.checkMarkerGeofence=function(p,m){if(p.fences){for(var q,r=0;q=p.fences[r];r++){var a=p.getPosition();this.checkGeofence(a.lat(),a.lng(),q)||m(p,q)}}},d.prototype.toImage=function(m){var m=m||{},a={};if(a.size=m.size||[this.el.clientWidth,this.el.clientHeight],a.lat=this.getCenter().lat(),a.lng=this.getCenter().lng(),0<this.markers.length){a.markers=[];for(var n=0;n<this.markers.length;n++){a.markers.push({lat:this.markers[n].getPosition().lat(),lng:this.markers[n].getPosition().lng()})}}return 0<this.polylines.length&&(m=this.polylines[0],a.polyline={},a.polyline.path=google.maps.geometry.encoding.encodePath(m.getPath()),a.polyline.strokeColor=m.strokeColor,a.polyline.strokeOpacity=m.strokeOpacity,a.polyline.strokeWeight=m.strokeWeight),d.staticMapURL(a)},d.staticMapURL=function(O){var B=[],F=("file:"===location.protocol?"http:":location.protocol)+"//maps.googleapis.com/maps/api/staticmap";O.url&&(F=O.url,delete O.url),F+="?";var G=O.markers;delete O.markers,!G&&O.marker&&(G=[O.marker],delete O.marker);var K=O.styles;delete O.styles;var D=O.polyline;delete O.polyline,O.center?(B.push("center="+O.center),delete O.center):O.address?(B.push("center="+O.address),delete O.address):O.lat?(B.push(["center=",O.lat,",",O.lng].join("")),delete O.lat,delete O.lng):O.visible&&(C=encodeURI(O.visible.join("|")),B.push("visible="+C));var C=O.size;C?(C.join&&(C=C.join("x")),delete O.size):C="630x300",B.push("size="+C),O.zoom||!1===O.zoom||(O.zoom=15);C=!O.hasOwnProperty("sensor")||!!O.sensor;for(Q in delete O.sensor,B.push("sensor="+C),O){O.hasOwnProperty(Q)&&B.push(Q+"="+O[Q])}if(G){for(var R,I,E=0;q=G[E];E++){for(var Q in R=[],q.size&&"normal"!==q.size?(R.push("size:"+q.size),delete q.size):q.icon&&(R.push("icon:"+encodeURI(q.icon)),delete q.icon),q.color&&(R.push("color:"+q.color.replace("#","0x")),delete q.color),q.label&&(R.push("label:"+q.label[0].toUpperCase()),delete q.label),I=q.address||q.lat+","+q.lng,delete q.address,delete q.lat,delete q.lng,q){q.hasOwnProperty(Q)&&R.push(Q+":"+q[Q])}R.length||0===E?(R.push(I),R=R.join("|"),B.push("markers="+encodeURI(R))):(R=B.pop()+encodeURI("|"+I),B.push(R))}}if(K){for(E=0;E<K.length;E++){var M=[];K[E].featureType&&M.push("feature:"+K[E].featureType.toLowerCase()),K[E].elementType&&M.push("element:"+K[E].elementType.toLowerCase());for(var L=0;L<K[E].stylers.length;L++){for(var A in K[E].stylers[L]){var P=K[E].stylers[L][A];"hue"!=A&&"color"!=A||(P="0x"+P.substring(1)),M.push(A+":"+P)}}var H=M.join("|");""!=H&&B.push("style="+H)}}function N(m,a){if("#"===m[0]&&(m=m.replace("#","0x"),a)){if(a=parseFloat(a),0===(a=Math.min(1,Math.max(a,0)))){return"0x00000000"}1===(a=(255*a).toString(16)).length&&(a+=a),m=m.slice(0,8)+a}return m}if(D){var q=D,D=[];q.strokeWeight&&D.push("weight:"+parseInt(q.strokeWeight,10)),q.strokeColor&&(C=N(q.strokeColor,q.strokeOpacity),D.push("color:"+C)),q.fillColor&&(J=N(q.fillColor,q.fillOpacity),D.push("fillcolor:"+J));var z=q.path;if(z.join){for(var x,L=0;x=z[L];L++){D.push(x.join(","))}}else{D.push("enc:"+z)}D=D.join("|"),B.push("path="+encodeURI(D))}var J=window.devicePixelRatio||1;return B.push("scale="+J),F+(B=B.join("&"))},d.prototype.addMapType=function(m,a){if(!a.hasOwnProperty("getTileUrl")||"function"!=typeof a.getTileUrl){throw"'getTileUrl' function required."}a.tileSize=a.tileSize||new google.maps.Size(256,256);a=new google.maps.ImageMapType(a);this.map.mapTypes.set(m,a)},d.prototype.addOverlayMapType=function(m){if(!m.hasOwnProperty("getTile")||"function"!=typeof m.getTile){throw"'getTile' function required."}var a=m.index;delete m.index,this.map.overlayMapTypes.insertAt(a,m)},d.prototype.removeOverlayMapType=function(a){this.map.overlayMapTypes.removeAt(a)},d.prototype.addStyle=function(m){var a=new google.maps.StyledMapType(m.styles,{name:m.styledMapName});this.map.mapTypes.set(m.mapTypeId,a)},d.prototype.setStyle=function(a){this.map.setMapTypeId(a)},d.prototype.createPanorama=function(a){return a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")||(a.lat=this.getCenter().lat(),a.lng=this.getCenter().lng()),this.panorama=d.createPanorama(a),this.map.setStreetView(this.panorama),this.panorama},d.createPanorama=function(m){var q=j(m.el,m.context);m.position=new google.maps.LatLng(m.lat,m.lng),delete m.el,delete m.context,delete m.lat,delete m.lng;for(var s=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],u=h({visible:!0},m),a=0;a<s.length;a++){delete u[s[a]]}for(var p=new google.maps.StreetViewPanorama(q,u),a=0;a<s.length;a++){!function(n){m[n]&&google.maps.event.addListener(p,n,function(){m[n].apply(this)})}(s[a])}return p},d.prototype.on=function(m,a){return d.on(m,this,a)},d.prototype.off=function(a){d.off(a,this)},d.prototype.once=function(m,a){return d.once(m,this,a)},d.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"],d.on=function(m,a,n){if(-1==d.custom_events.indexOf(m)){return a instanceof d&&(a=a.map),google.maps.event.addListener(a,m,n)}n={handler:n,eventName:m};return a.registered_events[m]=a.registered_events[m]||[],a.registered_events[m].push(n),n},d.off=function(m,a){-1==d.custom_events.indexOf(m)?(a instanceof d&&(a=a.map),google.maps.event.clearListeners(a,m)):a.registered_events[m]=[]},d.once=function(m,a,n){if(-1==d.custom_events.indexOf(m)){return a instanceof d&&(a=a.map),google.maps.event.addListenerOnce(a,m,n)}},d.fire=function(p,m,q){if(-1==d.custom_events.indexOf(p)){google.maps.event.trigger(m,p,Array.prototype.slice.apply(arguments).slice(2))}else{if(p in q.registered_events){for(var r=q.registered_events[p],a=0;a<r.length;a++){r[a].handler.apply(q,[m])}}}},d.geolocate=function(a){var m=a.always||a.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(n){a.success(n),m&&m()},function(n){a.error(n),m&&m()},a.options):(a.not_supported(),m&&m())},d.geocode=function(a){this.geocoder=new google.maps.Geocoder;var m=a.callback;a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")&&(a.latLng=new google.maps.LatLng(a.lat,a.lng)),delete a.lat,delete a.lng,delete a.callback,this.geocoder.geocode(a,function(o,n){m(o,n)})},"object"==typeof window.google&&window.google.maps&&(google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(q){for(var m,s=new google.maps.LatLngBounds,u=this.getPaths(),a=0;a<u.getLength();a++){m=u.getAt(a);for(var p=0;p<m.getLength();p++){s.extend(m.getAt(p))}}return s}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(y){var B=this.getBounds();if(null!==B&&!B.contains(y)){return !1}for(var u=!1,v=this.getPaths().getLength(),x=0;x<v;x++){for(var m=this.getPaths().getAt(x),C=m.getLength(),A=C-1,w=0;w<C;w++){var q=m.getAt(w),z=m.getAt(A);(q.lng()<y.lng()&&z.lng()>=y.lng()||z.lng()<y.lng()&&q.lng()>=y.lng())&&q.lat()+(y.lng()-q.lng())/(z.lng()-q.lng())*(z.lat()-q.lat())<y.lat()&&(u=!u),A=w}}return u}),google.maps.Circle.prototype.containsLatLng||(google.maps.Circle.prototype.containsLatLng=function(a){return !google.maps.geometry||google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(),a)<=this.getRadius()}),google.maps.Rectangle.prototype.containsLatLng=function(a){return this.getBounds().contains(a)},google.maps.LatLngBounds.prototype.containsLatLng=function(a){return this.contains(a)},google.maps.Marker.prototype.setFences=function(a){this.fences=a},google.maps.Marker.prototype.addFence=function(a){this.fences.push(a)},google.maps.Marker.prototype.getId=function(){return this.__gm_id}),Array.prototype.indexOf||(Array.prototype.indexOf=function(p){if(null==this){throw new TypeError}var m=Object(this),q=m.length>>>0;if(0==q){return -1}var r=0;if(1<arguments.length&&((r=Number(arguments[1]))!=r?r=0:0!=r&&r!=1/0&&r!=-1/0&&(r=(0<r||-1)*Math.floor(Math.abs(r)))),q<=r){return -1}for(var a=0<=r?r:Math.max(q-Math.abs(r),0);a<q;a++){if(a in m&&m[a]===p){return a}}return -1}),d});